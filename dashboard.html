<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Dashboard — Twin-Supply</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/styles.css"/>
</head>
<body>
  <div class="topbar">
    <div class="wrap nav">
      <a class="logo" href="index.html"><span class="mark"></span> Twin-Supply</a>
      <div class="navlinks">
        <a href="index.html">Home</a>
        <a href="shop.html">Shop</a>
        <a href="cart.html">Cart</a>
        <a href="admin.html">Admin</a>
        <a href="dashboard.html" class="active">Dashboard</a>
      </div>
      <a class="pill" href="cart.html">Cart <span id="cart-count" class="badge">0</span></a>
    </div>
  </div>

  <main class="wrap">
    <div class="notice" style="margin-top:14px">
      Tip: Settings are saved per browser. If this store is opened using different URLs (file:// vs http://localhost), your saved settings/cart won't carry over.
      Always run with Live Server for consistent data.
    </div>


    <section class="panel">
      <div class="panelInner">
        <div class="sectionHead">
          <h2>Dashboard</h2>
          <div style="display:flex;gap:10px;flex-wrap:wrap;justify-content:flex-end">
            <button id="export-btn" class="btn" type="button">Export Backup</button>
            <label class="btn" style="cursor:pointer">
              Import
              <input id="import-file" type="file" accept="application/json" style="display:none" />
            </label>
            <a class="btn" href="admin.html">Products</a>
            <button id="dash-logout" class="btn" type="button">Logout</button>
          </div>
        </div>
        <div class="hr"></div>

        <div class="kpiGrid">
          <div class="kpiCard">
            <div class="kicker">Revenue</div>
            <div class="kpiValue" id="kpi-revenue">$0.00</div>
            <div class="kpiSub" id="kpi-revenue-sub">Paid / shipped / delivered</div>
          </div>
          <div class="kpiCard">
            <div class="kicker">Profit</div>
            <div class="kpiValue" id="kpi-profit">$0.00</div>
            <div class="kpiSub">After COGS, fees, labels</div>
          </div>
          <div class="kpiCard">
            <div class="kicker">Orders</div>
            <div class="kpiValue" id="kpi-orders">0</div>
            <div class="kpiSub" id="kpi-pending">Pending: 0</div>
          </div>
          <div class="kpiCard">
            <div class="kicker">Units sold</div>
            <div class="kpiValue" id="kpi-units">0</div>
            <div class="kpiSub">Paid orders only</div>
          </div>
        </div>

      </div>
    </section>

    <div class="adminGrid">
      <!-- Orders -->
      <section class="panel">
        <div class="panelInner">
          <div class="sectionHead">
            <h2>Orders</h2>
            <div style="display:flex;gap:10px;flex-wrap:wrap;justify-content:flex-end">
              <button id="orders-clear" class="btn btnDanger" type="button">Clear All Orders</button>
            </div>
          </div>
          <div class="hr"></div>

          <div class="tableWrap">
            <table class="table" id="orders-table">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Order</th>
                  <th>Status</th>
                  <th>Total</th>
                  <th>Profit</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody id="orders-tbody"></tbody>
            </table>
          </div>

          <div id="order-detail" style="display:none;margin-top:12px" class="panel">
            <div class="panelInner">
              <div class="sectionHead">
                <h2 style="margin:0">Order details</h2>
                <button id="detail-close" class="btn" type="button">Close</button>
              </div>
              <div class="hr"></div>
              <div id="order-detail-body" class="list"></div>
            </div>
          </div>

        </div>
      </section>

      <!-- Tools + Settings -->
      <section class="panel">
        <div class="panelInner">
          <h2>Tools</h2>
          <div class="hr"></div>

          <div class="kicker">Price & profit calculator</div>

          <div class="inlineRow">
            <div class="field" style="flex:1">
              <label>Selling price</label>
              <input id="calc-price" type="number" step="0.01" placeholder="0"/>
            </div>
            <div class="field" style="flex:1">
              <label>Product cost (COGS)</label>
              <input id="calc-cost" type="number" step="0.01" placeholder="0"/>
            </div>
          </div>

          <div class="inlineRow">
            <div class="field" style="flex:1">
              <label>Shipping label cost</label>
              <input id="calc-ship" type="number" step="0.01" placeholder="0"/>
            </div>
            <div class="field" style="flex:1">
              <label>Extra costs</label>
              <input id="calc-extra" type="number" step="0.01" placeholder="0"/>
            </div>
          </div>

          <div class="inlineRow">
            <div class="field" style="flex:1">
              <label>Fee % (example: 2.9)</label>
              <input id="calc-fee-percent" type="number" step="0.01" placeholder="2.9"/>
            </div>
            <div class="field" style="flex:1">
              <label>Fee fixed</label>
              <input id="calc-fee-fixed" type="number" step="0.01" placeholder="0.30"/>
            </div>
          </div>

          <div style="margin-top:12px;display:flex;gap:10px;flex-wrap:wrap">
            <button id="calc-run" class="btn btnPrimary" type="button">Calculate</button>
          </div>

          <div class="miniCard" style="margin-top:12px">
            <div class="miniRow"><span>Estimated profit</span><b id="calc-profit">$0.00</b></div>
            <div class="miniRow"><span>Margin</span><b id="calc-margin">0%</b></div>
            <div class="miniRow"><span>Break-even price</span><b id="calc-breakeven">$0.00</b></div>
          </div>

          <div class="hr" style="margin-top:14px"></div>

          <h2>Store settings</h2>

          <div class="inlineRow">
            <div class="field" style="flex:1">
              <label>Currency</label>
              <input id="set-currency" placeholder="USD"/>
            </div>
            <div class="field" style="flex:1">
              <label>Tax rate (%)</label>
              <input id="set-tax" type="number" step="0.01" placeholder="0"/>
            </div>
          </div>

          <div class="inlineRow">
            <div class="field" style="flex:1">
              <label>Fee percent (example: 0.029)</label>
              <input id="set-fee-percent" type="number" step="0.001" placeholder="0.029"/>
            </div>
            <div class="field" style="flex:1">
              <label>Fee fixed</label>
              <input id="set-fee-fixed" type="number" step="0.01" placeholder="0.30"/>
            </div>
          </div>

          <div class="kicker" style="margin-top:10px">Shipping prices (charged to customer)</div>
          <div class="inlineRow">
            <div class="field" style="flex:1">
              <label>Standard</label>
              <input id="ship-standard" type="number" step="0.01" placeholder="7.99"/>
            </div>
            <div class="field" style="flex:1">
              <label>Express</label>
              <input id="ship-express" type="number" step="0.01" placeholder="14.99"/>
            </div>
          </div>
          <div class="inlineRow">
            <div class="field" style="flex:1">
              <label>Pickup</label>
              <input id="ship-pickup" type="number" step="0.01" placeholder="0"/>
            </div>
            <div class="field" style="flex:1">
              
          <div class="kicker" style="margin-top:14px">Payments</div>
          <div class="field">
            <label>PayPal Client ID (use Sandbox Client ID for testing)</label>
            <input id="paypal-client-id" placeholder="Paste your PayPal Client ID here"/>
          </div>

          <div class="inlineRow">
            <div class="field" style="flex:1">
              <label>PayPal mode</label>
              <select id="paypal-mode">
                <option value="sandbox">Sandbox (testing)</option>
                <option value="live">Live</option>
              </select>
            </div>
            <div class="field" style="flex:1">
              <label>Brand name (optional)</label>
              <input id="paypal-brand" placeholder="Twin-Supply"/>
            </div>
          </div>

          <div class="kicker" style="margin-top:14px">Cash App Pay (Square) (optional)</div>
          <div class="field">
            <label>Square Application ID</label>
            <input id="square-app-id" placeholder="Sandbox/Production Application ID"/>
          </div>
          <div class="field">
            <label>Square Location ID</label>
            <input id="square-location-id" placeholder="Your Square Location ID"/>
          </div>
          <div class="inlineRow">
            <div class="field" style="flex:1">
              <label>Square environment</label>
              <select id="square-env">
                <option value="sandbox">Sandbox (testing)</option>
                <option value="live">Live</option>
              </select>
            </div>
            <div class="field" style="flex:1">
              <label>Square API base URL (Vercel)</label>
              <input id="square-api-base" placeholder="https://twin-supply.vercel.app"/>
            </div>
          </div>
          <div class="kicker" style="color:var(--muted);margin-top:8px">
            Cash App Pay uses the Square Web Payments SDK + a serverless API. Add your Square access token in Vercel env vars as <b>SQUARE_ACCESS_TOKEN</b>.
          </div>


          <div class="kicker" style="margin-top:14px">Order notifications (optional)</div>
          <div class="field">
            <label>Order webhook URL (example: Google Apps Script Web App URL)</label>
            <input id="order-webhook-url" placeholder="https://script.google.com/macros/s/....../exec"/>
          </div>
          <div class="field">
            <label>Webhook token (optional)</label>
            <input id="order-webhook-token" placeholder="Any secret word"/>
          </div>
<label>&nbsp;</label>
              <button id="save-settings" class="btn" type="button">Save settings</button>
            </div>
          </div>

          <div id="settings-msg" style="color:var(--muted);font-weight:900;margin-top:8px"></div>

        </div>
      </section>
    </div>

    <section class="panel">
      <div class="panelInner">
        <div class="sectionHead">
          <h2>Inventory purchases (restocks)</h2>
        </div>
        <div class="hr"></div>

        <div class="adminGrid">
          <div class="panel">
            <div class="panelInner">
              <div class="kicker">Add purchase</div>

              <div class="inlineRow">
                <div class="field" style="flex:1">
                  <label>Date</label>
                  <input id="pur-date" type="date"/>
                </div>
                <div class="field" style="flex:1">
                  <label>Vendor (optional)</label>
                  <input id="pur-vendor" placeholder="Supplier"/>
                </div>
              </div>

              <div class="inlineRow">
                <div class="field" style="flex:1">
                  <label>Product</label>
                  <select id="pur-product"></select>
                </div>
                <div class="field" style="flex:1">
                  <label>Qty</label>
                  <input id="pur-qty" type="number" min="1" step="1" value="1"/>
                </div>
              </div>

              <div class="inlineRow">
                <div class="field" style="flex:1">
                  <label>Unit cost</label>
                  <input id="pur-cost" type="number" min="0" step="0.01" placeholder="0"/>
                </div>
                <div class="field" style="flex:1">
                  <label>Notes</label>
                  <input id="pur-notes" placeholder="Notes"/>
                </div>
              </div>

              <div style="margin-top:12px;display:flex;gap:10px;flex-wrap:wrap">
                <button id="pur-save" class="btn btnPrimary" type="button">Save purchase</button>
              </div>
              <div id="pur-msg" style="color:var(--muted);font-weight:900;margin-top:8px"></div>

            </div>
          </div>

          <div class="panel">
            <div class="panelInner">
              <div class="kicker">Recent purchases</div>
              <div class="tableWrap">
                <table class="table">
                  <thead>
                    <tr>
                      <th>Date</th>
                      <th>Product</th>
                      <th>Qty</th>
                      <th>Unit</th>
                      <th>Total</th>
                    </tr>
                  </thead>
                  <tbody id="purchases-tbody"></tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

      </div>
    </section>

    <footer>
      <span>© Twin-Supply</span>
      <span>Dashboard</span>
    </footer>

  
  </main>

  <script src="js/products.js"></script>
  <script src="js/cart.js"></script>
  <script src="js/dashboard.js"></script>
</body>
</html>
